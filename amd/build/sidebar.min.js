define(["jquery","core/ajax","core/log","core/notification","core/templates","core/config"],function(a,b,c,d,e){"use strict";var f={options:{open:!1,instanceid:0},setOptions:function(a){var b,c;for(b in this.options)this.options.hasOwnProperty(b)&&a.hasOwnProperty(b)&&(c=typeof this.options[b],"boolean"===c?this.options[b]=Boolean(a[b]):"number"===c?this.options[b]=Number(a[b]):"string"===c?this.options[b]=String(a[b]):this.options[b]=a[b])},start:function(){c.debug("block_fastnav/sidebar: start()"),c.debug(this.options),this.loadNavigation()},loadNavigation:function(){var g=b.call([{methodname:"block_fastnav_get_items",args:{instanceid:this.options.instanceid}}]);g[0].done(function(b){return 0===b.items.length?void c.debug("block_fastnav/sidebar: no items."):void e.render("block_fastnav/block_item_list",b).done(function(b){a("body").prepend('<nav class="block-fastnav-sidebar">'+b+"</nav>"),f.loadEvents()}).fail(d.exception)}).fail(d.exception)},openOrClose:function(){var b=a(".block-fastnav-sidebar");return 80!==b.width()?void b.animate({width:"80px"},300,function(){c.debug("block_fastnav/sidebar: Animation complete."),b.find(".fa-arrow-left").removeClass("fa-arrow-left").addClass("fa-arrow-right")}):void b.animate({width:0},300,function(){c.debug("block_fastnav/sidebar: Animation complete."),b.find(".fa-arrow-right").addClass("fa-arrow-left").removeClass("fa-arrow-right")})},loadEvents:function(){c.debug("block_fastnav/sidebar: loadEvents()"),a(".block-fastnav-lock.active").length&&f.openOrClose(),a("body").on("mouseover",".block-fastnav-opener",function(){f.openOrClose()}),a("body").on("click",".block-fastnav-lock",function(){var b=a(this),d=b.hasClass("active");return c.debug("block_fastnav/sidebar: locked ",d),d?(b.removeClass("active"),f.updateOpenPreference("0"),void f.openOrClose()):(b.addClass("active"),void f.updateOpenPreference("1"))});try{a(".block-fastnav-sidebar a").tooltip()}catch(b){c.debug("block_fastnav/sidebar: bootstrap tooltip not available ")}},updateOpenPreference:function(a){M.util.set_user_preference("block_fastnav_open",a)}};return{init:function(a){f.setOptions(a),f.start()}}});