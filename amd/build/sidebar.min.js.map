{"version":3,"sources":["../src/sidebar.js"],"names":["define","$","Ajax","Log","Notification","Templates","sidebar","options","open","instanceid","setOptions","key","vartype","hasOwnProperty","start","debug","loadNavigation","promises","call","methodname","args","done","response","items","length","render","html","prepend","loadEvents","fail","exception","openOrClose","$sidebar","width","animate","find","removeClass","addClass","on","event","$el","currentTarget","locked","hasClass","updateOpenPreference","tooltip","e","status","M","util","set_user_preference","init","params"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Javascript fast navigation interactive sidebar\n *\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n *\n * @package   block_fastnav\n * @copyright 17/07/2020 Mfreak.nl | LdesignMedia.nl - Luuk Verhoeven\n * @author    Luuk Verhoeven\n **/\ndefine(['jquery', 'core/ajax', 'core/log', 'core/notification', 'core/templates', 'core/config'],\n    function($, Ajax, Log, Notification, Templates) {\n        'use strict';\n\n        var sidebar = {\n\n            options: {\n                open: false,\n                instanceid: 0\n            },\n\n            /**\n             * Set options base on listed options\n             * @param {object} options\n             */\n            setOptions: function(options) {\n                var key, vartype;\n                for (key in this.options) {\n                    if (this.options.hasOwnProperty(key) && options.hasOwnProperty(key)) {\n                        // Casting to prevent errors.\n                        vartype = typeof this.options[key];\n                        if (vartype === \"boolean\") {\n                            this.options[key] = Boolean(options[key]);\n                        } else if (vartype === 'number') {\n                            this.options[key] = Number(options[key]);\n                        } else if (vartype === 'string') {\n                            this.options[key] = String(options[key]);\n                        } else {\n                            this.options[key] = options[key];\n                        }\n                    }\n                }\n            },\n\n            /**\n             * Start\n             */\n            start: function() {\n                Log.debug('block_fastnav/sidebar: start()');\n                Log.debug(this.options);\n\n                // Load template.\n                this.loadNavigation();\n            },\n\n            /**\n             * Add sidebar\n             */\n            loadNavigation: function() {\n                var promises = Ajax.call([{\n                    methodname: 'block_fastnav_get_items',\n                    args: {\n                        instanceid: this.options.instanceid,\n                    }\n                }]);\n                promises[0].done(function(response) {\n\n                    if (response.items.length === 0) {\n                        Log.debug('block_fastnav/sidebar: no items.');\n                        return;\n                    }\n\n                    Templates.render('block_fastnav/block_item_list', response)\n                        .done(function(html) {\n                            $('body').prepend('<nav class=\"block-fastnav-sidebar\">' + html + '</nav>');\n                            sidebar.loadEvents();\n                        }).fail(Notification.exception);\n\n                }).fail(Notification.exception);\n            },\n\n            /**\n             * Open or close the fastnav sidebar\n             */\n            openOrClose: function() {\n\n                var $sidebar = $('.block-fastnav-sidebar');\n                if ($sidebar.width() !== 80) {\n                    $sidebar.animate({\n                        width: '80px',\n                    }, 300, function() {\n                        Log.debug('block_fastnav/sidebar: Animation complete.');\n                        $sidebar.find('.fa-arrow-left').removeClass('fa-arrow-left').addClass('fa-arrow-right');\n                    });\n                    return;\n                }\n\n                $sidebar.animate({\n                    width: 0,\n                }, 300, function() {\n                    Log.debug('block_fastnav/sidebar: Animation complete.');\n                    $sidebar.find('.fa-arrow-right').addClass('fa-arrow-left').removeClass('fa-arrow-right');\n                });\n            },\n\n            /**\n             * Check for some DOM events.\n             */\n            loadEvents: function() {\n                Log.debug('block_fastnav/sidebar: loadEvents()');\n\n                if ($('.block-fastnav-lock.active').length) {\n                    sidebar.openOrClose();\n                }\n\n                $('body').on('mouseover', '.block-fastnav-opener', function() {\n                    sidebar.openOrClose();\n                });\n\n                $('body').on('click', '.block-fastnav-lock', function(event) {\n\n                    // Check current status.\n                    var $el = $(event.currentTarget);\n                    var locked = $el.hasClass('active');\n                    Log.debug('block_fastnav/sidebar: locked ', locked);\n\n                    if (locked) {\n                        $el.removeClass('active');\n                        sidebar.updateOpenPreference('0');\n                        sidebar.openOrClose();\n                        return;\n                    }\n\n                    $el.addClass('active');\n                    sidebar.updateOpenPreference('1');\n                });\n\n                // Reload bootstrap tooltip.\n                try {\n                    $('.block-fastnav-sidebar a').tooltip();\n                } catch (e) {\n                    Log.debug('block_fastnav/sidebar: bootstrap tooltip not available ');\n                }\n            },\n\n            /**\n             *\n             * @param {string} status\n             */\n            updateOpenPreference: function(status) {\n                M.util.set_user_preference('block_fastnav_open', status);\n            }\n        };\n\n        return {\n\n            /**\n             *\n             * @param {object} params\n             */\n            init: function(params) {\n                sidebar.setOptions(params);\n                sidebar.start();\n            }\n        };\n    });"],"file":"sidebar.min.js"}